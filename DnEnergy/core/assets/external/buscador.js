function resetSearch(){const hasText=()=>($('#buscador2').val()!=undefined&&$('#buscador2').val().length>0)?$('#borrarBusqueda').text('×'):$('#borrarBusqueda').text('');ultimaBusqueda="";$('#buscador, #buscador2').val("")
$(".buscador i").removeClass("fas fa-spinner fa-spin");$(".buscador i").addClass("fas fa-search");hasText();if(empresa_estilo[0].sn_carga_dinamica==0){$('.cartas').show();$('.swiper-slide').show();$('.all .producto').prev(".tituloCateg").show();$('.all .producto').show();$(".all .tituloCateg").show()
if(typeof swipers!=='undefined'&&swipers.length==1){swipers[0].update();}
if(typeof swipers!=='undefined'&&empresa_estilo[0].template!="YA"){swipers.forEach(function(swip){swip.params.spaceBetween=15;swip.params.centeredSlides=device()?true:false;swip.params.slidesPerView=device()?(window.innerWidth-5)/225:4;swip.update();});}}else{if(typeof vueContenidoTemplate!=='undefined'){let categ_activa=$(".historia.active").attr("categ");vueContenidoTemplate.cambiarCategoria(categ_activa);}}}
var ultimaBusqueda="";var timerBuscando;$(document).ready(function(){const goTo=function(dir,dis){$('#scroll').animate({scrollTop:((dir.offset().top*$("#scroll").scrollTop()/dir.offset().top+dir.offset().top)-dis)},300);}
$("button.side-menu").addClass("active");$(".buscador2").addClass("active");$(".navegador").addClass("top");$("#buscador, #buscador2").on("focus",function(event){var heightPaginaPersonal=0;if(!device()){heightPaginaPersonal=($("#menuBackground").height()!=undefined?$("#menuBackground").height():0)+10;}else{heightPaginaPersonal=($(".buscador2").height()!=undefined?$(".buscador2").height():0)+10;}
goTo($('#contenidoTemplate'),$(".categoriasHorizontales").height()+heightPaginaPersonal);});$('#buscador, #buscador2').on("input",function(event){var heightPaginaPersonal=0;if(!device()){heightPaginaPersonal=($("#menuBackground").height()!=undefined?$("#menuBackground").height():0)+10;}else{heightPaginaPersonal=($(".buscador2").height()!=undefined?$(".buscador2").height():0)+10;}
if($('#buscador').val().length==0&&$('#buscador2').val().length==0){resetSearch();}else{var searchCount=$(this).val().length;$(".buscador i").removeClass("fas fa-search");$(".buscador i").addClass("fas fa-spinner fa-spin");if(timerBuscando!=undefined){clearInterval(timerBuscando);}
timerBuscando=window.setTimeout(()=>{var buscando=$(this).val().toLowerCase();if(searchCount==$(this).val().length&&ultimaBusqueda!=buscando){$(".filtroAtributo input:checked").prop("checked",false);ultimaBusqueda=buscando;var nombres=$('section.producto');var item='';if(empresa_estilo[0].sn_carga_dinamica==0){$('.cartas').hide();$('.swiper-slide').hide();$('.all .tituloCateg').hide();$('.all .producto').hide();for(var i=0;i<nombres.length;i++){item=$(nombres[i]).attr("nombre-field").toLowerCase();for(var x=0;x<item.length;x++){if(buscando.length==0||item.indexOf(buscando)>-1){$(nombres[i]).prevAll(".tituloCateg:first").show();$(nombres[i]).show();$(nombres[i]).parents('.cartas').show();$(nombres[i]).parents('.swiper-slide').show();$(nombres[i]).parents(".cartas").find(".tituloCateg").show()}}
item=$(nombres[i]).find(".descripcion p").text().toLowerCase();for(var x=0;x<item.length;x++){if(buscando.length==0||item.indexOf(buscando)>-1){$(nombres[i]).prevAll(".tituloCateg:first").show();$(nombres[i]).show();$(nombres[i]).parents('.cartas').show();$(nombres[i]).parents('.swiper-slide').show();$(nombres[i]).parents(".cartas").find(".tituloCateg").show()}}}
if(typeof swipers!=='undefined'&&swipers.length==1){swipers[0].update();$(".swiper-wrapper").css("height","auto");}
goTo($('#contenidoTemplate'),$(".categoriasHorizontales").height()+heightPaginaPersonal);$(".buscador i").removeClass("fas fa-spinner fa-spin");$(".buscador i").addClass("fas fa-search");}else{buscadorDinamico(buscando);}}else{$(".buscador i").removeClass("fas fa-spinner fa-spin");$(".buscador i").addClass("fas fa-search");}},1000);}});$(".overlay").on('click',function(){if($(".navegadorMobile").hasClass("active")){navegador()}
if($("#filtrosVariaciones").hasClass("active")){$("#filtrosVariaciones").removeClass("active");$(".overlay").hide();}});const hasText=()=>($('#buscador2').val()!=undefined&&$('#buscador2').val().length>0)?$('#borrarBusqueda').text('×'):$('#borrarBusqueda').text('');hasText();$('#buscador2').on('input',()=>hasText());$('#borrarBusqueda').click(()=>{resetSearch();});$(".navegador .title input").focusout(function(){$(".navegador .title").removeClass("active")})})
function buscadorDinamico(buscarProducto){var x=-1;var tmpUrl=urlBaseAdmin+"/cruds/productos/api.php";$.ajax({data:{"id_empresa":idE,"buscarProducto":buscarProducto},url:tmpUrl,type:'post',dataType:'json',async:false,success:function(response){var data=JSON.stringify(response);data=$.parseJSON(data);if(data.message!=undefined){removeLoader();showToast("warning","Lo sentimos",data.message);}else if(data.error!=undefined){console.log(data.error);removeLoader();}else{if(data.productos!=undefined){x=data.productos;productos=x;vueContenidoTemplate.cambiarCategoria(-1);}else{console.log(data);removeLoader();}}
$(".buscador i").removeClass("fas fa-spinner fa-spin");$(".buscador i").addClass("fas fa-search");},error:function(request,status,error){console.log(request.responseText);removeLoader();$(".buscador i").removeClass("fas fa-spinner fa-spin");$(".buscador i").addClass("fas fa-search");return-1;}});return x;}